---
layout: post
title: '适配器模式'
date: 2023-04-21
description: '适配器模式'
tags: '设计模式'
--- 

适配器中的代码将接受你所拥有的接口，并产生你所需要的接口。适配器模式使得原本由于接口不匹配而不能一起工作的那些类可以一起工作。

## 适配器模式在使用场景的具体实现

现有一个适配器，一号口是typec口，二号口是vga口，只有将视频信号从typec口输入，转换输出到vga口，才能和投影仪对接，实现手机屏幕投影到投影仪上的任务。涉及的物品有：手机、适配器、投影仪。

**定义一个手机，它有个typec口，这是视频源。**

```java
public class Phone {
    public void typePhone() {
        System.out.println("信息从Typec口的手机输出。");
    }
}
```

**定义一个vga接口**

```java
public interface Vga {
    void vgaInterface();
}
```

### 实现一个适配器，适配器实现方式分三类：类的适配器模式、对象的适配器模式、接口的适配器模式。

### 类的适配器模式

原理：通过继承特性来实现适配器功能

```java
/**
 * 实现一个Type-c转VGA适配器；
 * 适配器实现方式有三种，这是第一种实现方式。
 */
public class Typec2Vga1 extends Phone implements Vga{
    @Override
    public void vgaInterface() {
        typePhone();
        System.out.println("接收到Type-c口信息，信息转换成VGA接口中...");
        System.out.println("信息已转换成VGA接口，显示屏可以对接。");
    }
}
```

### 对象的适配器模式

原理：通过组合方式来实现适配器功能

```java
/**
 * 实现一个Type-c转VGA适配器；
 * 适配器实现方式有三种，这是第二种实现方式。
 */
public class Type2Vga2 implements Vga {
    private Phone phone;
    
    public Type2Vga2(Phone phone) {
        this.phone = phone;
    }

    @Override
    public void vgaInterface() {
        if(phone != null) {
            phone.typePhone();
            System.out.println("接收到Type-c口信息，信息转换成VGA接口中...");
            System.out.println("信息已转换成VGA接口，显示屏可以对接。")
        }
    }
}
```

### 接口的适配器模式

原理：借助抽象类来实现适配器功能。

定义三个接口

```java
public interface Target {
    void typec();
    void type2vga();
    void type2hdmi();
}
```

```java
public abstract class Adapter implements Target {
    public void typec() {}
    public void type2vga() {}
    public void type2hdmi() {}
}
```

实现一个VGA适配器

```java
/**
 * 实现一个Type-c转VGA适配器；
 * 适配器实现方式有三种，这是第三种实现方式。
 */
public class VgaAdapter extends Adapter{
    public void typec() {
        System.out.println("信息从Typec口的手机输出。")
    }
    public void tapec2vga() {
        System.out.println("接口到Type-c口信息，信息转换成VGA接口中...");
        System.out.println("信息已转换成VGA接口，显示屏可以对接。");
    }
}
```
### 定义一个显示屏，用来测试上面实现的适配器

```java
package com.jstao.adapter;

/**
 * 定义一个显示屏
 * 与适配器对接
 */
public class Screen {
    public static void main(String[] args) {
        //第一种适配器用法
        System.out.println("-------------第一种适配器------------");
        Vga vga = new Typec2Vga1();
        vga.vgaInterface();//适配器将typec转换成vga
        System.out.println("显示屏对接适配器，手机成功投影到显示屏!");
        
        //第二种适配器用法
        System.out.println("-------------第二种适配器------------");
        Typec2Vga2 typec2Vga1 = new Typec2Vga2(new Phone());
        typec2Vga1.vgaInterface();//适配器将typec转换成vga
        System.out.println("显示屏对接适配器，手机成功投影到显示屏!");
        
        //第三种适配器用法
        System.out.println("-------------第三种适配器------------");
        VgaAdapter vgaAdapter = new VgaAdapter();
        vgaAdapter.typec();
        vgaAdapter.typec2vga();//适配器将typec转换成vga
        System.out.println("显示屏对接适配器，手机成功投影到显示屏!");
    }
}
```

## 小结

### 适配器模式在原码中的应用：
1. JDK源码的IO模块用到，例如Java.io.InputStreamReader(InputStream)、java.io.OutputStreamWriter(OutputStream)。
2. mybatis源码日志模块用到对象适配器模式。

### 适配器模式将一个接口转为另外一个接口。它有三种实现方式：
1. 当希望将一个类转换为满足另一个新接口的类时，可以使用*类的适配器模式*，创建一个新类，继承原有的类，实现新的接口即可。
2. 当希望将一个对象转换成满足另一个新接口的对象时，可以创建一个Typec2Vga2类，持有原类的一个实例，在Typec2Vga2类的方法中，调用实例的方法就行。
3. 当不希望实现一个接口中所有的方法时，可以创建一个抽象类Adatper，实现所有方法，我们写别的类的时候，继承抽象类即可。
